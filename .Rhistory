f<-(b+c)/(d+e)+
patchwork::plot_layout(guides = "collect")+
patchwork::plot_annotation(title = "Cross-Validation Results",
subtitle = gene_name)
f
f<-(b+c)/(d+e)+
patchwork::plot_layout(guides = "collect")
f
a<-results$By_Class_Parameters
#run permutational analysis
fit<-locus_perm_cv(n_perms = 2, #the number of permutations
geno_mat=geno_mat, #the genotypic matrix
gene_file=genecomp, #the gene compendium file
gene_name="sst1_solid_stem", #the name of the gene
marker_info=marker_info, #the marker information file
chromosome="3B", #name of the chromosome
ncor_markers=50, #number of markers to retain
percent_testing=0.2, #percentage of genotypes in the validation set
percent_training=0.8, #percentage of genotypes in the training set
include_hets=T, #excludes hets in the model
include_models=F, #excludes models in results object
verbose = T) #excludes text
results=fit
a<-results$By_Class_Parameters
a<-results$Overall_Parameters
b<-ggplot2::ggplot(data = a, aes(y=Accuracy, x=Model, fill=Model))+
ggplot2::geom_boxplot()+
ggplot2::theme_bw()+
ggplot2::theme(axis.text.x = ggplot2::element_blank(),
axis.ticks.x = ggplot2::element_blank())
c<-ggplot2::ggplot(data = a, aes(y=Kappa, x=Model, fill=Model))+
ggplot2::geom_boxplot()+
ggplot2::theme_bw()+
ggplot2::theme(axis.text.x = ggplot2::element_blank(),
axis.ticks.x = ggplot2::element_blank(),
legend.position = "none")
a<-results$By_Class_Parameters
d<-ggplot2::ggplot(data = a, aes(y=Sensitivity, x=Model, fill=Model))+
ggplot2::geom_boxplot()+
ggplot2::theme_bw()+
ggplot2::theme(axis.text.x = ggplot2::element_blank(),
axis.ticks.x = ggplot2::element_blank(),
legend.position = "none")
View(a)
d<-ggplot2::ggplot(data = a, aes(y=Sensitivity, x=Model, fill=Model))+
ggplot2::facet_grid(~Class)+
ggplot2::geom_boxplot()+
ggplot2::theme_bw()+
ggplot2::theme(axis.text.x = ggplot2::element_blank(),
axis.ticks.x = ggplot2::element_blank(),
legend.position = "none")
d
d<-ggplot2::ggplot(data = a, aes(y=Sensitivity, x=Model, fill=Model))+
ggplot2::facet_grid(~base::paste("Class =", Class))+
ggplot2::geom_boxplot()+
ggplot2::theme_bw()+
ggplot2::theme(axis.text.x = ggplot2::element_blank(),
axis.ticks.x = ggplot2::element_blank(),
legend.position = "none")
d
a<-results$By_Class_Parameters
d<-ggplot2::ggplot(data = a, aes(y=Sensitivity, x=Model, fill=Model))+
ggplot2::facet_grid(~base::paste("Class =", Class))+
ggplot2::geom_boxplot()+
ggplot2::theme_bw()+
ggplot2::theme(axis.text.x = ggplot2::element_blank(),
axis.ticks.x = ggplot2::element_blank(),
legend.position = "none")
e<-ggplot2::ggplot(data = a, aes(y=Specificity, x=Model, fill=Model))+
ggplot2::facet_grid(~base::paste("Class =", Class))+
ggplot2::geom_boxplot()+
ggplot2::theme_bw()+
ggplot2::theme(axis.text.x = ggplot2::element_blank(),
axis.ticks.x = ggplot2::element_blank(),
legend.position = "none")
e
if(base::is.null(results$By_Class_Parameters$Class)){
a<-results$By_Class_Parameters
d<-ggplot2::ggplot(data = a, aes(y=Sensitivity, x=Model, fill=Model))+
ggplot2::geom_boxplot()+
ggplot2::theme_bw()+
ggplot2::theme(axis.text.x = ggplot2::element_blank(),
axis.ticks.x = ggplot2::element_blank(),
legend.position = "none")
e<-ggplot2::ggplot(data = a, aes(y=Specificity, x=Model, fill=Model))+
ggplot2::geom_boxplot()+
ggplot2::theme_bw()+
ggplot2::theme(axis.text.x = ggplot2::element_blank(),
axis.ticks.x = ggplot2::element_blank(),
legend.position = "none")
f<-(b+c)/(d+e)+
patchwork::plot_layout(guides = "collect")
f
}else{
a<-results$By_Class_Parameters
d<-ggplot2::ggplot(data = a, aes(y=Sensitivity, x=Model, fill=Model))+
ggplot2::facet_grid(~base::paste("Class =", Class))+
ggplot2::geom_boxplot()+
ggplot2::theme_bw()+
ggplot2::theme(axis.text.x = ggplot2::element_blank(),
axis.ticks.x = ggplot2::element_blank(),
legend.position = "none")
e<-ggplot2::ggplot(data = a, aes(y=Specificity, x=Model, fill=Model))+
ggplot2::facet_grid(~base::paste("Class =", Class))+
ggplot2::geom_boxplot()+
ggplot2::theme_bw()+
ggplot2::theme(axis.text.x = ggplot2::element_blank(),
axis.ticks.x = ggplot2::element_blank(),
legend.position = "none")
f<-(b+c)/(d+e)+
patchwork::plot_layout(guides = "collect")
f
}
a<-results$By_Class_Parameters
a<-results$By_Class_Parameters
b<-ggplot2::ggplot(data = a, aes(y=Accuracy, x=Model, fill=Model))+
ggplot2::facet_grid(~base::paste("Class =", Class))+
ggplot2::geom_boxplot()+
ggplot2::theme_bw()+
ggplot2::theme(axis.text.x = ggplot2::element_blank(),
axis.ticks.x = ggplot2::element_blank())
c<-ggplot2::ggplot(data = a, aes(y=Kappa, x=Model, fill=Model))+
ggplot2::facet_grid(~base::paste("Class =", Class))+
ggplot2::geom_boxplot()+
ggplot2::theme_bw()+
ggplot2::theme(axis.text.x = ggplot2::element_blank(),
axis.ticks.x = ggplot2::element_blank(),
legend.position = "none")
d<-ggplot2::ggplot(data = a, aes(y=Sensitivity, x=Model, fill=Model))+
ggplot2::facet_grid(~base::paste("Class =", Class))+
ggplot2::geom_boxplot()+
ggplot2::theme_bw()+
ggplot2::theme(axis.text.x = ggplot2::element_blank(),
axis.ticks.x = ggplot2::element_blank(),
legend.position = "none")
e<-ggplot2::ggplot(data = a, aes(y=Specificity, x=Model, fill=Model))+
ggplot2::facet_grid(~base::paste("Class =", Class))+
ggplot2::geom_boxplot()+
ggplot2::theme_bw()+
ggplot2::theme(axis.text.x = ggplot2::element_blank(),
axis.ticks.x = ggplot2::element_blank(),
legend.position = "none")
f<-(b+c)/(d+e)+
patchwork::plot_layout(guides = "collect")
f
results$By_Class_Parameters
a<-results$By_Class_Parameters
b<-ggplot2::ggplot(data = a, aes(y=Balanced_Accuracy, x=Model, fill=Model))+
ggplot2::facet_grid(~base::paste("Class =", Class))+
ggplot2::geom_boxplot()+
ggplot2::theme_bw()+
ggplot2::theme(axis.text.x = ggplot2::element_blank(),
axis.ticks.x = ggplot2::element_blank())+
ggplot2::labs(y="Balanced Accuracy")
c<-ggplot2::ggplot(data = a, aes(y=Kappa, x=Model, fill=Model))+
ggplot2::facet_grid(~base::paste("Class =", Class))+
ggplot2::geom_boxplot()+
ggplot2::theme_bw()+
ggplot2::theme(axis.text.x = ggplot2::element_blank(),
axis.ticks.x = ggplot2::element_blank(),
legend.position = "none")
d<-ggplot2::ggplot(data = a, aes(y=Sensitivity, x=Model, fill=Model))+
ggplot2::facet_grid(~base::paste("Class =", Class))+
ggplot2::geom_boxplot()+
ggplot2::theme_bw()+
ggplot2::theme(axis.text.x = ggplot2::element_blank(),
axis.ticks.x = ggplot2::element_blank(),
legend.position = "none")
e<-ggplot2::ggplot(data = a, aes(y=Specificity, x=Model, fill=Model))+
ggplot2::facet_grid(~base::paste("Class =", Class))+
ggplot2::geom_boxplot()+
ggplot2::theme_bw()+
ggplot2::theme(axis.text.x = ggplot2::element_blank(),
axis.ticks.x = ggplot2::element_blank(),
legend.position = "none")
f<-(b+c)/(d+e)+
patchwork::plot_layout(guides = "collect")
f
a
if(base::is.null(results$By_Class_Parameters$Class)){
a<-results$Overall_Parameters
b<-ggplot2::ggplot(data = a, aes(y=Accuracy, x=Model, fill=Model))+
ggplot2::geom_boxplot()+
ggplot2::theme_bw()+
ggplot2::theme(axis.text.x = ggplot2::element_blank(),
axis.ticks.x = ggplot2::element_blank())+
ggplot2::labs(title = "Overall Accuracy")
c<-ggplot2::ggplot(data = a, aes(y=Kappa, x=Model, fill=Model))+
ggplot2::geom_boxplot()+
ggplot2::theme_bw()+
ggplot2::theme(axis.text.x = ggplot2::element_blank(),
axis.ticks.x = ggplot2::element_blank(),
legend.position = "none")+
ggplot2::labs(title = "Overall Kappa")
a<-results$By_Class_Parameters
d<-ggplot2::ggplot(data = a, aes(y=Sensitivity, x=Model, fill=Model))+
ggplot2::geom_boxplot()+
ggplot2::theme_bw()+
ggplot2::theme(axis.text.x = ggplot2::element_blank(),
axis.ticks.x = ggplot2::element_blank(),
legend.position = "none")+
ggplot2::labs(title = "Overall Sensitivity")
e<-ggplot2::ggplot(data = a, aes(y=Specificity, x=Model, fill=Model))+
ggplot2::geom_boxplot()+
ggplot2::theme_bw()+
ggplot2::theme(axis.text.x = ggplot2::element_blank(),
axis.ticks.x = ggplot2::element_blank(),
legend.position = "none")+
ggplot2::labs(title = "Overall Specificity")
f<-(b+c)/(d+e)+
patchwork::plot_layout(guides = "collect")
f
}else{
a<-results$By_Class_Parameters
b<-ggplot2::ggplot(data = a, aes(y=Accuracy, x=Model, fill=Model))+
ggplot2::geom_boxplot()+
ggplot2::theme_bw()+
ggplot2::theme(axis.text.x = ggplot2::element_blank(),
axis.ticks.x = ggplot2::element_blank())+
ggplot2::labs(title = "Overall Accuracy")
c<-ggplot2::ggplot(data = a, aes(y=Kappa, x=Model, fill=Model))+
ggplot2::geom_boxplot()+
ggplot2::theme_bw()+
ggplot2::theme(axis.text.x = ggplot2::element_blank(),
axis.ticks.x = ggplot2::element_blank(),
legend.position = "none")+
ggplot2::labs(title = "Overall Kappa")
d<-ggplot2::ggplot(data = a, aes(y=Sensitivity, x=Model, fill=Model))+
ggplot2::facet_grid(~base::paste("Class =", Class))+
ggplot2::geom_boxplot()+
ggplot2::theme_bw()+
ggplot2::theme(axis.text.x = ggplot2::element_blank(),
axis.ticks.x = ggplot2::element_blank(),
legend.position = "none")+
ggplot2::labs(title = "By-Class Sensitivity")
e<-ggplot2::ggplot(data = a, aes(y=Specificity, x=Model, fill=Model))+
ggplot2::facet_grid(~base::paste("Class =", Class))+
ggplot2::geom_boxplot()+
ggplot2::theme_bw()+
ggplot2::theme(axis.text.x = ggplot2::element_blank(),
axis.ticks.x = ggplot2::element_blank(),
legend.position = "none")+
ggplot2::labs(title = "By-Class Specificity")
f<-(b+c)/(d+e)+
patchwork::plot_layout(guides = "collect")
f
}
if(base::is.null(results$By_Class_Parameters$Class)){
a<-results$Overall_Parameters
b<-ggplot2::ggplot(data = a, aes(y=Accuracy, x=Model, fill=Model))+
ggplot2::geom_boxplot()+
ggplot2::theme_bw()+
ggplot2::theme(axis.text.x = ggplot2::element_blank(),
axis.ticks.x = ggplot2::element_blank())+
ggplot2::labs(title = "Overall Accuracy")
c<-ggplot2::ggplot(data = a, aes(y=Kappa, x=Model, fill=Model))+
ggplot2::geom_boxplot()+
ggplot2::theme_bw()+
ggplot2::theme(axis.text.x = ggplot2::element_blank(),
axis.ticks.x = ggplot2::element_blank(),
legend.position = "none")+
ggplot2::labs(title = "Overall Kappa")
a<-results$By_Class_Parameters
d<-ggplot2::ggplot(data = a, aes(y=Sensitivity, x=Model, fill=Model))+
ggplot2::geom_boxplot()+
ggplot2::theme_bw()+
ggplot2::theme(axis.text.x = ggplot2::element_blank(),
axis.ticks.x = ggplot2::element_blank(),
legend.position = "none")+
ggplot2::labs(title = "Overall Sensitivity")
e<-ggplot2::ggplot(data = a, aes(y=Specificity, x=Model, fill=Model))+
ggplot2::geom_boxplot()+
ggplot2::theme_bw()+
ggplot2::theme(axis.text.x = ggplot2::element_blank(),
axis.ticks.x = ggplot2::element_blank(),
legend.position = "none")+
ggplot2::labs(title = "Overall Specificity")
f<-(b+c)/(d+e)+
patchwork::plot_layout(guides = "collect")
f
}else{
a<-results$Overall_Parameters
b<-ggplot2::ggplot(data = a, aes(y=Accuracy, x=Model, fill=Model))+
ggplot2::geom_boxplot()+
ggplot2::theme_bw()+
ggplot2::theme(axis.text.x = ggplot2::element_blank(),
axis.ticks.x = ggplot2::element_blank())+
ggplot2::labs(title = "Overall Accuracy")
c<-ggplot2::ggplot(data = a, aes(y=Kappa, x=Model, fill=Model))+
ggplot2::geom_boxplot()+
ggplot2::theme_bw()+
ggplot2::theme(axis.text.x = ggplot2::element_blank(),
axis.ticks.x = ggplot2::element_blank(),
legend.position = "none")+
ggplot2::labs(title = "Overall Kappa")
d<-ggplot2::ggplot(data = a, aes(y=Sensitivity, x=Model, fill=Model))+
ggplot2::facet_grid(~base::paste("Class =", Class))+
ggplot2::geom_boxplot()+
ggplot2::theme_bw()+
ggplot2::theme(axis.text.x = ggplot2::element_blank(),
axis.ticks.x = ggplot2::element_blank(),
legend.position = "none")+
ggplot2::labs(title = "By-Class Sensitivity")
e<-ggplot2::ggplot(data = a, aes(y=Specificity, x=Model, fill=Model))+
ggplot2::facet_grid(~base::paste("Class =", Class))+
ggplot2::geom_boxplot()+
ggplot2::theme_bw()+
ggplot2::theme(axis.text.x = ggplot2::element_blank(),
axis.ticks.x = ggplot2::element_blank(),
legend.position = "none")+
ggplot2::labs(title = "By-Class Specificity")
f<-(b+c)/(d+e)+
patchwork::plot_layout(guides = "collect")
f
}
if(base::is.null(results$By_Class_Parameters$Class)){
a<-results$Overall_Parameters
b<-ggplot2::ggplot(data = a, aes(y=Accuracy, x=Model, fill=Model))+
ggplot2::geom_boxplot()+
ggplot2::theme_bw()+
ggplot2::theme(axis.text.x = ggplot2::element_blank(),
axis.ticks.x = ggplot2::element_blank())+
ggplot2::labs(title = "Overall Accuracy")
c<-ggplot2::ggplot(data = a, aes(y=Kappa, x=Model, fill=Model))+
ggplot2::geom_boxplot()+
ggplot2::theme_bw()+
ggplot2::theme(axis.text.x = ggplot2::element_blank(),
axis.ticks.x = ggplot2::element_blank(),
legend.position = "none")+
ggplot2::labs(title = "Overall Kappa")
a<-results$By_Class_Parameters
d<-ggplot2::ggplot(data = a, aes(y=Sensitivity, x=Model, fill=Model))+
ggplot2::geom_boxplot()+
ggplot2::theme_bw()+
ggplot2::theme(axis.text.x = ggplot2::element_blank(),
axis.ticks.x = ggplot2::element_blank(),
legend.position = "none")+
ggplot2::labs(title = "Overall Sensitivity")
e<-ggplot2::ggplot(data = a, aes(y=Specificity, x=Model, fill=Model))+
ggplot2::geom_boxplot()+
ggplot2::theme_bw()+
ggplot2::theme(axis.text.x = ggplot2::element_blank(),
axis.ticks.x = ggplot2::element_blank(),
legend.position = "none")+
ggplot2::labs(title = "Overall Specificity")
f<-(b+c)/(d+e)+
patchwork::plot_layout(guides = "collect")
f
}else{
a<-results$Overall_Parameters
b<-ggplot2::ggplot(data = a, aes(y=Accuracy, x=Model, fill=Model))+
ggplot2::geom_boxplot()+
ggplot2::theme_bw()+
ggplot2::theme(axis.text.x = ggplot2::element_blank(),
axis.ticks.x = ggplot2::element_blank())+
ggplot2::labs(title = "Overall Accuracy")
c<-ggplot2::ggplot(data = a, aes(y=Kappa, x=Model, fill=Model))+
ggplot2::geom_boxplot()+
ggplot2::theme_bw()+
ggplot2::theme(axis.text.x = ggplot2::element_blank(),
axis.ticks.x = ggplot2::element_blank(),
legend.position = "none")+
ggplot2::labs(title = "Overall Kappa")
a<-results$By_Class_Parameters
d<-ggplot2::ggplot(data = a, aes(y=Sensitivity, x=Model, fill=Model))+
ggplot2::facet_grid(~base::paste("Class =", Class))+
ggplot2::geom_boxplot()+
ggplot2::theme_bw()+
ggplot2::theme(axis.text.x = ggplot2::element_blank(),
axis.ticks.x = ggplot2::element_blank(),
legend.position = "none")+
ggplot2::labs(title = "By-Class Sensitivity")
e<-ggplot2::ggplot(data = a, aes(y=Specificity, x=Model, fill=Model))+
ggplot2::facet_grid(~base::paste("Class =", Class))+
ggplot2::geom_boxplot()+
ggplot2::theme_bw()+
ggplot2::theme(axis.text.x = ggplot2::element_blank(),
axis.ticks.x = ggplot2::element_blank(),
legend.position = "none")+
ggplot2::labs(title = "By-Class Specificity")
f<-(b+c)/(d+e)+
patchwork::plot_layout(guides = "collect")
f
}
library(GrainBreed)
devtools::load_all(".")
?plot_locus_perm_cv
#### for locus_perm_cv ####
#read in the genotypic data matrix
data("geno_mat")
#read in the marker information
data("marker_info")
#read in the gene compendium file
data("genecomp")
#run permutational analysis
fit<-locus_perm_cv(n_perms = 2, #the number of permutations
geno_mat=geno_mat, #the genotypic matrix
gene_file=genecomp, #the gene compendium file
gene_name="sst1_solid_stem", #the name of the gene
marker_info=marker_info, #the marker information file
chromosome="3B", #name of the chromosome
ncor_markers=50, #number of markers to retain
percent_testing=0.2, #percentage of genotypes in the validation set
percent_training=0.8, #percentage of genotypes in the training set
include_hets=T, #excludes hets in the model
include_models=F, #excludes models in results object
verbose = T) #excludes text
#### for plot_locus_perm_cv ####
plot_locus_perm_cv(fit)
devtools::load_all(".")
#### for plot_locus_perm_cv ####
plot_locus_perm_cv(fit)
#run permutational analysis
fit<-locus_perm_cv(n_perms = 3, #the number of permutations
geno_mat=geno_mat, #the genotypic matrix
gene_file=genecomp, #the gene compendium file
gene_name="sst1_solid_stem", #the name of the gene
marker_info=marker_info, #the marker information file
chromosome="3B", #name of the chromosome
ncor_markers=50, #number of markers to retain
percent_testing=0.2, #percentage of genotypes in the validation set
percent_training=0.8, #percentage of genotypes in the training set
include_hets=F, #excludes hets in the model
include_models=F, #excludes models in results object
verbose = F) #excludes text
#### for plot_locus_perm_cv ####
plot_locus_perm_cv(fit)
devtools::load_all(".")
?plot_locus_perm_cv
devtools::load_all(".")
?plot_locus_perm_cv
library(utils)
rename("GrainBreed", "HapploMapper")
library(devtools)
library(HaploMapper)
devtools::load_all(".")
?locus_cv
?locus_perm_cv
library(devtools)
?use_mit_license
#read in the genotypic data matrix
data("geno_mat")
#read in the marker information
data("marker_info")
#read in the gene compendium file
data("genecomp")
#run the function with hets
fit1<-locus_cv(geno_mat=geno_mat, #the genotypic matrix
gene_file=genecomp, #the gene compendium file
gene_name="sst1_solid_stem", #the name of the gene
marker_info=marker_info, #the marker information file
chromosome="3B", #name of the chromosome
ncor_markers=50, #number of markers to retain
percent_testing=0.2, #percentage of genotypes in the validation set
percent_training=0.8, #percentage of genotypes in the training set
include_hets=T, #include hets in the model
include_models=T, #include models in the final results
verbose = T) #allows for text and graph output
#fun the function without hets
fit2<-locus_cv(geno_mat=geno_mat, #the genotypic matrix
gene_file=genecomp, #the gene compendium file
gene_name="sst1_solid_stem", #the name of the gene
marker_info=marker_info, #the marker information file
chromosome="3B", #name of the chromosome
ncor_markers=50, #number of markers to retain
percent_testing=0.2, #percentage of genotypes in the validation set
percent_training=0.8, #percentage of genotypes in the training set
include_hets=F, #excludes hets in the model
include_models=F, #excludes models in the final results
verbose = T) #silences function
#### for locus_perm_cv ####
#read in the genotypic data matrix
data("geno_mat")
#read in the marker information
data("marker_info")
#read in the gene compendium file
data("genecomp")
#run permutational analysis
fit<-locus_perm_cv(n_perms = 3, #the number of permutations
geno_mat=geno_mat, #the genotypic matrix
gene_file=genecomp, #the gene compendium file
gene_name="sst1_solid_stem", #the name of the gene
marker_info=marker_info, #the marker information file
chromosome="3B", #name of the chromosome
ncor_markers=50, #number of markers to retain
percent_testing=0.2, #percentage of genotypes in the validation set
percent_training=0.8, #percentage of genotypes in the training set
include_hets=F, #excludes hets in the model
include_models=F, #excludes models in results object
verbose = F) #excludes text
#### for plot_locus_perm_cv ####
plot_locus_perm_cv(fit)
?install_github
install_github("Zachary Winn/zjwinn")
library(HaploMapper)
citation(HaploMapper)
citation("HaploMapper")
devtools::load_all(".")
citation("HaploMapper")
devtools::load_all(".")
citation("HaploMapper")
citation("HaploMapper")
citation("HaploMapper")
devtools::load_all(".")
devtools::load_all(".")
citation("HaploMapper")
devtools::load_all(".")
citation("HaploMapper")
citation("HaploMapper")
citation("HaploMapper")
citation("HaploMapper")
citation("HaploMapper")
